%% abtex2-modelo-artigo.tex, v-1.9.6 laurocesar
%% Copyright 2012-2016 by abnTeX2 group at http://www.abntex.net.br/ 
%%
%% This work may be distributed and/or modified under the
%% conditions of the LaTeX Project Public License, either version 1.3
%% of this license or (at your option) any later version.
%% The latest version of this license is in
%%   http://www.latex-project.org/lppl.txt
%% and version 1.3 or later is part of all distributions of LaTeX
%% version 2005/12/01 or later.
%%
%% This work has the LPPL maintenance status `maintained'.
%% 
%% The Current Maintainer of this work is the abnTeX2 team, led
%% by Lauro César Araujo. Further information are available on 
%% http://www.abntex.net.br/
%%
%% This work consists of the files abntex2-modelo-artigo.tex and
%% abntex2-modelo-references.bib
%%

% ------------------------------------------------------------------------
% ------------------------------------------------------------------------
% abnTeX2: Modelo de Artigo Acadêmico em conformidade com
% ABNT NBR 6022:2003: Informação e documentação - Artigo em publicação 
% periódica científica impressa - Apresentação
% ------------------------------------------------------------------------
% ------------------------------------------------------------------------

\documentclass[
    % -- opções da classe memoir --
    article,            % indica que é um artigo acadêmico
    11pt,               % tamanho da fonte
    oneside,            % para impressão apenas no recto. Oposto a twoside
    a4paper,            % tamanho do papel. 
    % -- opções da classe abntex2 --
    %chapter=TITLE,     % títulos de capítulos convertidos em letras maiúsculas
    %section=TITLE,     % títulos de seções convertidos em letras maiúsculas
    %subsection=TITLE,  % títulos de subseções convertidos em letras maiúsculas
    %subsubsection=TITLE % títulos de subsubseções convertidos em letras maiúsculas
    % -- opções do pacote babel --
    english,            % idioma adicional para hifenização
    brazil,             % o último idioma é o principal do documento
    sumario=tradicional,
    ]{abntex2}


% ---
% PACOTES
% ---
\usepackage[table,xcdraw]{xcolor}

% ---
% Pacotes fundamentais 
% ---
\usepackage{lmodern}            % Usa a fonte Latin Modern
\usepackage[T1]{fontenc}        % Selecao de codigos de fonte.
\usepackage[utf8]{inputenc}     % Codificacao do documento (conversão automática dos acentos)
\usepackage{indentfirst}        % Indenta o primeiro parágrafo de cada seção.
\usepackage{nomencl}            % Lista de simbolos
\usepackage{color}              % Controle das cores
\usepackage{graphicx}           % Inclusão de gráficos
\usepackage{microtype}          % para melhorias de justificação
% ---
        
% ---
% Pacotes adicionais, usados apenas no âmbito do Modelo Canônico do abnteX2
% ---
\usepackage{lipsum}             % para geração de dummy text
\usepackage{fancyvrb}
\usepackage{todonotes}
\usepackage{float}
\usepackage[procnames]{listings}
\usepackage{color}
\usepackage{amsmath}
% ---
        
% ---
% Pacotes de citações
% ---
\usepackage[brazilian,hyperpageref]{backref}     % Paginas com as citações na bibl
\usepackage[alf]{abntex2cite}   % Citações padrão ABNT
% ---

% ---
% Configurações do pacote backref
% Usado sem a opção hyperpageref de backref
\renewcommand{\backrefpagesname}{Citado na(s) página(s):~}
% Texto padrão antes do número das páginas
\renewcommand{\backref}{}
% Define os textos da citação
\renewcommand*{\backrefalt}[4]{
    \ifcase #1 %
        Nenhuma citação no texto.%
    \or
        Citado na página #2.%
    \else
        Citado #1 vezes nas páginas #2.%
    \fi}%
% ---

% ---
% Informações de dados para CAPA e FOLHA DE ROSTO
% ---
\titulo{Relatório INE5429\\Segurança em Computação\\ 
        Números Primos}
\autor{Bruno Marques do Nascimento\thanks{brunomn95@gmail.com \hspace{1mm} - \hspace{1mm} Universidade Federal de Santa Catarina}}
\instituicao{Universidade Federal de Santa Catarina}
\local{Florianópolis - SC, Brasil}
\data{14 de Abril de 2018}
% ---

% ---
% Configurações de aparência do PDF final

% alterando o aspecto da cor azul
\definecolor{blue}{RGB}{41,5,195}

% informações do PDF
\makeatletter
\hypersetup{
        %pagebackref=true,
        pdftitle={\@title}, 
        pdfauthor={\@author},
        pdfsubject={},
        pdfcreator={LaTeX with abnTeX2},
        pdfkeywords={abnt}{latex}{abntex}{abntex2}{atigo científico}, 
        colorlinks=true,            % false: boxed links; true: colored links
        linkcolor=black,             % color of internal links
        citecolor=black,             % color of links to bibliography
        filecolor=magenta,              % color of file links
        urlcolor=black,
        bookmarksdepth=4
}
\makeatother
% --- 

% ---
% compila o indice
% ---
\makeindex
% ---

% ---
% Altera as margens padrões
% ---
\setlrmarginsandblock{3cm}{3cm}{*}
\setulmarginsandblock{3cm}{3cm}{*}
\checkandfixthelayout
% ---

% --- 
% Espaçamentos entre linhas e parágrafos 
% --- 

% O tamanho do parágrafo é dado por:
\setlength{\parindent}{1.3cm}

% Controle do espaçamento entre um parágrafo e outro:
\setlength{\parskip}{0.2cm}  % tente também \onelineskip

% Espaçamento simples
\SingleSpacing

% ----
% Início do documento
% ----
\begin{document}

% Seleciona o idioma do documento (conforme pacotes do babel)
%\selectlanguage{english}
\selectlanguage{brazil}

% Retira espaço extra obsoleto entre as frases.
\frenchspacing 

% ----------------------------------------------------------
% ELEMENTOS PRÉ-TEXTUAIS
% ----------------------------------------------------------

%---
%
% Se desejar escrever o artigo em duas colunas, descomente a linha abaixo
% e a linha com o texto ``FIM DE ARTIGO EM DUAS COLUNAS''.
% \twocolumn[           % INICIO DE ARTIGO EM DUAS COLUNAS
%
%---
% página de titulo

\maketitle


% ----------------------------------------------------------
% ELEMENTOS TEXTUAIS
% ----------------------------------------------------------
\textual

% ----------------------------------------------------------
% Introdução
% ----------------------------------------------------------
% \section*{Introdução}
% \addcontentsline{toc}{section}{Introdução}

\section*{\textbf{Algoritmos:}}
\addcontentsline{toc}{section}{Algoritmos}

% ----------------------------------------------------------
% Questão 1
% ----------------------------------------------------------
\setcounter{section}{0}
\section{\textbf{Teste de primalidade de Miller-Rabin}}
\label{miller-rabin}

O teste de primalidade de Miller-Rabin é um algoritmo que testa se um dado número $n$ é primo probabilisticamente. Este teste utiliza-se de um conjunto de igualdades que são válidas para números primos, e que são utilizadas para testar a primalidade de $n$. Ele se baseia no lema de Euclides e na contrapositiva do lema de Fermat. Sendo assim, ao realizar um teste sobre o número $n$ se for encontrado um $a$, tal que $a^d \not\equiv 1 \pmod n$ e $a^{2^rd} \not\equiv -1 \pmod n$ para todo $0 \leq r \leq s-1$, então $n$ não é primo.

\begin{table}[H]
\centering
\caption{Miller-Rabin (6 execuções)}
\label{bbs-table}
\begin{tabular}{|c|c|c|}
\hline
\rowcolor[HTML]{C0C0C0} 
\textbf{\begin{tabular}[c]{@{}c@{}}Tamanho do Número\\(bits)\end{tabular}} & \textbf{\begin{tabular}[c]{@{}c@{}}Tempo médio para\\gerar (microssegundos)\end{tabular}} & \textbf{\begin{tabular}[c]{@{}c@{}}Desvio Padrão\\(microssegundos)\end{tabular}} \\ \hline
40   &   2437,00       &  1576,05        \\ \hline
56   &   1233,34       &  3544,45        \\ \hline
80   &   9227,64       &  6484,48        \\ \hline
128  &   14064,55      &  34214,85       \\ \hline
168  &   42083,98      &  44683,58       \\ \hline
224  &   227973,35     &  172281,57      \\ \hline
256  &   61404,35      &  81073,24       \\ \hline
512  &   1023952,25    &  1716422,89     \\ \hline
1024 &   12457123,04   &  20190124,49    \\ \hline
2048 &   171019203,55  &  643825280,23   \\ \hline
4096 &   1044962651,26 &  1266221570,34  \\ \hline

\end{tabular}
\end{table}

\newpage

\definecolor{keywords}{RGB}{255,0,90}
\definecolor{comments}{RGB}{0,0,113}
\definecolor{red}{RGB}{160,0,0}
\definecolor{green}{RGB}{0,150,0}
\lstset{language=Python, 
        basicstyle=\ttfamily\scriptsize, 
        keywordstyle=\color{keywords},
        commentstyle=\color{comments},
        stringstyle=\color{red},
        showstringspaces=false,
        identifierstyle=\color{green},
        procnamekeys={def,class},
        inputencoding=utf8,
        literate={á}{{\'a}}1 {ó}{{\'o}}1 {é}{{\'e}}1 {í}{{\'i}}1 {ú}{{\'u}}1
             {ã}{{\~a}}1 {õ}{{\~o}}1
             {ç}{{\c{c}}}1,
}

\begin{lstlisting}[frame=single, title={miller-rabin.py}]
import random 
import sys
import time as t

MICRO = 1000000

def miller_rabin(n, k=40):
    # Casos <= 4
    if (n <= 1):     return False
    if (n <= 3):     return True
    if (n == 4):     return False
    if (n % 2 == 0): return False

    # Encontre inteiros s, d, com s > 0, d ímpar, de modo que (n - 1 = 2^s * d);
    d = n - 1
    s = 0
    while d % 2 == 0:
        d //= 2;
        s += 1     

    # Laço responsável por realizar k testes
    for _ in range(k):
        # Selecione um inteiro aleatório a, tal que 1 < a < n - 1;
        a = random.randrange(2, n-1)

        # if a^d mod n = 1 then return("inconclusive");
        x = pow(a, d, n)
        if x == 1 or x == n-1:
            return True

        # Laço que irá executar 's-1' vezes.
        for _ in range(s-1):
            x = pow(x,2,n)
            if x == 1:
                return False
            if x == n-1:
                return True

    return False

nbits = int(sys.argv[1]) # Número de bits, definido pelo usuário

start = t.time() # Tempo de início da execução.
while True:
    # Número aleatório com N bits
    n = random.getrandbits(nbits) 
    if miller_rabin(n) == True:
        break
end = t.time()  # Tempo de término da execução.

total_time = (end - start) * MICRO

print("Random value = " + str( n ))
print("%.2f" % total_time + " microssegundos")
\end{lstlisting}

\newpage
% ----------------------------------------------------------
% Questão 2
% ----------------------------------------------------------
\section{\textbf{Teste de primalidade de Fermat}}
\label{fermat}

Assim como o \nameref{miller-rabin}, o de Fermat também determina probabilisticamente quando um dado número $n$ é primo ou não. O teorema de Fermat diz que se $n$ é primo e $a$ não é divisível por $n$, então $a^{n-1} \equiv 1 \pmod n$, dessa maneira para testarmos se $n$ é primo, devemos selecionar valores aleatórios para $a$ que não são divisíveis por $n$, e observar se a equivalência se mantém verdadeira. Caso ela não se mantenha verdadeira para um valor de $a$, então $n$ não é primo. Assim, caso essa equivalência se mantenha verdadeira para um ou mais valores de $a$, $n$ é provavelmente primo. 

\begin{table}[H]
\centering
\caption{Fermat (6 execuções)}
\label{lcg-table}
\begin{tabular}{|c|c|c|}
\hline
\rowcolor[HTML]{C0C0C0} 
\textbf{\begin{tabular}[c]{@{}c@{}}Tamanho do Número\\(bits)\end{tabular}} & \textbf{\begin{tabular}[c]{@{}c@{}}Tempo médio para\\gerar (microssegundos)\end{tabular}} & \textbf{\begin{tabular}[c]{@{}c@{}}Desvio Padrão\\(microssegundos)\end{tabular}} \\ \hline
40     &   415,56          &     110,24         \\ \hline
56     &   566,00          &     177,19         \\ \hline
80     &   1048,92         &     309,24         \\ \hline
128    &   3080,24         &     1041,94        \\ \hline
168    &   7325,17         &     2426,65        \\ \hline
224    &   16478,18        &     28404,10       \\ \hline
256    &   12502,55        &     20410,04       \\ \hline
512    &   126065,61       &     50266,13       \\ \hline
1024   &   1056584,59      &     1100742,88     \\ \hline
2048   &   19111389,87     &     28232101,87    \\ \hline
4096   &   196762201,78    &     118842421,62   \\ \hline
\end{tabular}
\end{table}

\begin{lstlisting}[frame=single, title={fermat.py}]
import random 
import sys
import time as t

MICRO = 1000000

def fermat(n, k=40):
# Casos <= 4
    if (n <= 1):     return False
    if (n <= 3):     return True
    if (n == 4):     return False
    if (n % 2 == 0): return False

    for _ in range(k):
        a = random.randrange(2, n-1)

        if pow(a, n-1, n) != 1:
            return False

    return True

nbits = int(sys.argv[1]) # Número de bits, definido pelo usuário

start = t.time() # Tempo de início da execução.
while True:
    # Número aleatório com N bits
    n = random.getrandbits(nbits) 
    if fermat(n) == True:
        break
end = t.time()  # Tempo de término da execução.

total_time = (end - start) * MICRO

print("Random value = " + str( n ))
print("%.2f" % total_time + " microssegundos")
\end{lstlisting}




\section{\textbf{Comparação e complexidade}}

Ambos algoritmos implementados são muito parecidos, são testes de primalidade probabilisticas, que irão fornecer números primos que podem posteriormente ser testado de maneira mais incisiva. O \nameref{miller-rabin}  possui complexidade de $O(k \cdot log^3n)$ onde $k$ é a quantidade de diferentes valores para $a$ testados. \cite{miller_rabin_wiki}. E o \nameref{fermat} possui complexidade $Õ(k \cdot log^2n)$, \cite{fermat_wiki}.

\section{\textbf{Dificuldades encontradas}}

Devido a complexidade dos algoritmos, o tempo total para gerar um número e realizar o teste de primalidade sobre ele torna-se demorado quando o número de \textit{bits} começa a aumentar, podendo tomar mais de 30 minutos, por exemplo, ao tentar gerar um número primo de 4096 \textit{bits}. Outro fato relevante, é que este tempo é dependente da ``sorte'' de gerar um numero aleatório que seja primo para que o teste convirja rapidamente, acarretando em um elevado desvio padrão.


\section{\textbf{Execuções}}

\begin{table}[H]
\centering
\caption{Execuções Miller-Rabin}
\label{mr-execc-table}
\resizebox*{\textwidth}{!}{
\begin{tabular}{|
>{\columncolor[HTML]{C0C0C0}}l |l|l|l|l|l|l|
>{\columncolor[HTML]{DAE8FC}}l |l|}
\hline
BITS\textbackslash{}EXECUÇÃO & \cellcolor[HTML]{C0C0C0}1 & \cellcolor[HTML]{C0C0C0}2 & \cellcolor[HTML]{C0C0C0}3 & \cellcolor[HTML]{C0C0C0}4 & \cellcolor[HTML]{C0C0C0}5 & \cellcolor[HTML]{C0C0C0}6 & \cellcolor[HTML]{C0C0C0}MEDIA & \cellcolor[HTML]{C0C0C0}STD DEV       \\ \hline
40                           & 2339,84                   & 2743,96                   & 1082,66                   & 4654,65                   & 2534,15                   & 26,46                     & 2437,00                       & \cellcolor[HTML]{ECF4FF}1576,05       \\ \hline
56                           & 9079,69                   & 643,25                    & 23,84                     & 166,42                    & 4580,97                   & 1823,43                   & 1233,34                       & \cellcolor[HTML]{ECF4FF}3544,45       \\ \hline
80                           & 19163,61                  & 6067,28                   & 16526,94                  & 2106,43                   & 7554,53                   & 10900,74                  & 9227,64                       & \cellcolor[HTML]{ECF4FF}6484,48       \\ \hline
128                          & 74996,23                  & 544,31                    & 17953,16                  & 10175,94                  & 2077,1                    & 70564,03                  & 14064,55                      & \cellcolor[HTML]{ECF4FF}34214,85      \\ \hline
168                          & 50626,75                  & 33541,2                   & 128947,97                 & 18716,81                  & 15667,68                  & 89344,02                  & 42083,98                      & \cellcolor[HTML]{ECF4FF}44683,58      \\ \hline
224                          & 366577,39                 & 473574,16                 & 343026,88                 & 105931,76                 & 57917,36                  & 112919,81                 & 227973,35                     & \cellcolor[HTML]{ECF4FF}172281,57     \\ \hline
256                          & 25068,76                  & 187540,53                 & 212288,38                 & 54706,34                  & 68102,36                  & 37176,85                  & 61404,35                      & \cellcolor[HTML]{ECF4FF}81073,24      \\ \hline
512                          & 296193,36                 & 371868,37                 & 1380643,61                & 4848669,29                & 1838359,83                & 667260,89                 & 1023952,25                    & \cellcolor[HTML]{ECF4FF}1716422,89    \\ \hline
1024                         & 31207163,33               & 1754965,07                & 4173250,68                & 10158452,99               & 14755793,09               & 54736176,01               & 12457123,04                   & \cellcolor[HTML]{ECF4FF}20190124,49   \\ \hline
2048                         & 1748714846,37             & 132029213,43              & 107674439,67              & 171298158,41              & 170740248,68              & 340060755,01              & 171019203,55                  & \cellcolor[HTML]{ECF4FF}643825280,23  \\ \hline
4096                         & 374507446,53              & 1224821036,1              & 865104266,41              & 378419603,59              & 2000634170,77             & 3690580049,04             & 1044962651,26                 & \cellcolor[HTML]{ECF4FF}1266221570,34 \\ \hline
\end{tabular}}
\end{table}


\begin{table}[H]
\centering
\caption{Execuções Fermat}
\label{fer-execc-table}
\resizebox*{\textwidth}{!}{
\begin{tabular}{|
>{\columncolor[HTML]{C0C0C0}}l |l|l|l|l|l|l|
>{\columncolor[HTML]{DAE8FC}}l |l|}
\hline
BITS\textbackslash{}EXECUÇÃO & \cellcolor[HTML]{C0C0C0}1 & \cellcolor[HTML]{C0C0C0}2 & \cellcolor[HTML]{C0C0C0}3 & \cellcolor[HTML]{C0C0C0}4 & \cellcolor[HTML]{C0C0C0}5 & \cellcolor[HTML]{C0C0C0}6 & \cellcolor[HTML]{C0C0C0}MEDIA & \cellcolor[HTML]{C0C0C0}STD DEV       \\ \hline
40                           & 443,7                     & 375,03                    & 387,43                    & 383,14                    & 664,71                    & 478,03                    & 415,57                        & \cellcolor[HTML]{ECF4FF}110,24        \\ \hline
56                           & 552,18                    & 579,83                    & 927,45                    & 463,96                    & 511,17                    & 765,32                    & 566,01                        & \cellcolor[HTML]{ECF4FF}177,19        \\ \hline
80                           & 1654,39                   & 1067,16                   & 869,51                    & 1472,95                   & 990,63                    & 1030,68                   & 1048,92                       & \cellcolor[HTML]{ECF4FF}309,24        \\ \hline
128                          & 3141,4                    & 3112,79                   & 2456,9                    & 2285,24                   & 5201,34                   & 3047,7                    & 3080,25                       & \cellcolor[HTML]{ECF4FF}1041,94       \\ \hline
168                          & 7531,4                    & 5510,81                   & 11207,1                   & 4567,86                   & 9233,47                   & 7118,94                   & 7325,17                       & \cellcolor[HTML]{ECF4FF}2426,65       \\ \hline
224                          & 19263,03                  & 83230,97                  & 11532,31                  & 7150,41                   & 13693,33                  & 28469,09                  & 16478,18                      & \cellcolor[HTML]{ECF4FF}28404,10      \\ \hline
256                          & 12604                     & 8593,08                   & 29173,37                  & 61172,49                  & 12401,1                   & 10271,55                  & 12502,55                      & \cellcolor[HTML]{ECF4FF}20410,04      \\ \hline
512                          & 109261,27                 & 142869,95                 & 182988,41                 & 207906,96                 & 96101,76                  & 82098,01                  & 126065,61                     & \cellcolor[HTML]{ECF4FF}50266,13      \\ \hline
1024                         & 3349493,98                & 2081247,09                & 909789,8                  & 356384,52                 & 1203379,39                & 740375,28                 & 1056584,60                    & \cellcolor[HTML]{ECF4FF}1100742,88    \\ \hline
2048                         & 26155449,63               & 1641473,53                & 58278342,25               & 12067330,12               & 5318920,37                & 68050973,89               & 19111389,88                   & \cellcolor[HTML]{ECF4FF}28232101,87   \\ \hline
4096                         & 208888615,61              & 302012347,7               & 35766744,14               & 10214559,56               & 184635787,96              & 259303761,01              & 196762201,79                  & \cellcolor[HTML]{ECF4FF}118842421,62  \\ \hline
\end{tabular}}
\end{table}
% ---{}
% Finaliza a parte no bookmark do PDF, para que se inicie o bookmark na raiz
% ---
\bookmarksetup{startatroot}% 
% ---

% ---
% Conclusão
% ---
% \section*{Considerações finais}
% \addcontentsline{toc}{section}{Considerações finais}

% ----------------------------------------------------------
% ELEMENTOS PÓS-TEXTUAIS
% ----------------------------------------------------------
\postextual

% ----------------------------------------------------------
% Referências bibliográficas
% ----------------------------------------------------------
\nocite{Stallings:2013:CNS:2523199}
\nocite{miller_rabin_gfg}
\bibliography{bibliography}

\end{document}
